{"ast":null,"code":"import { __awaiter, __generator } from \"tslib\";\nexport var getAwsChunkedEncodingStream = function (readableStream, options) {\n  var base64Encoder = options.base64Encoder,\n      bodyLengthChecker = options.bodyLengthChecker,\n      checksumAlgorithmFn = options.checksumAlgorithmFn,\n      checksumLocationName = options.checksumLocationName,\n      streamHasher = options.streamHasher;\n  var checksumRequired = base64Encoder !== undefined && bodyLengthChecker !== undefined && checksumAlgorithmFn !== undefined && checksumLocationName !== undefined && streamHasher !== undefined;\n  var digest = checksumRequired ? streamHasher(checksumAlgorithmFn, readableStream) : undefined;\n  var reader = readableStream.getReader();\n  return new ReadableStream({\n    pull: function (controller) {\n      return __awaiter(this, void 0, void 0, function () {\n        var _a, value, done, checksum, _b;\n\n        return __generator(this, function (_c) {\n          switch (_c.label) {\n            case 0:\n              return [4, reader.read()];\n\n            case 1:\n              _a = _c.sent(), value = _a.value, done = _a.done;\n              if (!done) return [3, 4];\n              controller.enqueue(\"0\\r\\n\");\n              if (!checksumRequired) return [3, 3];\n              _b = base64Encoder;\n              return [4, digest];\n\n            case 2:\n              checksum = _b.apply(void 0, [_c.sent()]);\n              controller.enqueue(\"\".concat(checksumLocationName, \":\").concat(checksum, \"\\r\\n\"));\n              controller.enqueue(\"\\r\\n\");\n              _c.label = 3;\n\n            case 3:\n              controller.close();\n              return [3, 5];\n\n            case 4:\n              controller.enqueue(\"\".concat((bodyLengthChecker(value) || 0).toString(16), \"\\r\\n\").concat(value, \"\\r\\n\"));\n              _c.label = 5;\n\n            case 5:\n              return [2];\n          }\n        });\n      });\n    }\n  });\n};","map":{"version":3,"names":["__awaiter","__generator","getAwsChunkedEncodingStream","readableStream","options","base64Encoder","bodyLengthChecker","checksumAlgorithmFn","checksumLocationName","streamHasher","checksumRequired","undefined","digest","reader","getReader","ReadableStream","pull","controller","_a","value","done","checksum","_b","_c","label","read","sent","enqueue","apply","concat","close","toString"],"sources":["C:/Users/icean/aws-doc-sdk-examples/javascriptv3/example_code/cross-services/textract-react/node_modules/@aws-sdk/util-stream-browser/dist-es/getAwsChunkedEncodingStream.js"],"sourcesContent":["import { __awaiter, __generator } from \"tslib\";\nexport var getAwsChunkedEncodingStream = function (readableStream, options) {\n    var base64Encoder = options.base64Encoder, bodyLengthChecker = options.bodyLengthChecker, checksumAlgorithmFn = options.checksumAlgorithmFn, checksumLocationName = options.checksumLocationName, streamHasher = options.streamHasher;\n    var checksumRequired = base64Encoder !== undefined &&\n        bodyLengthChecker !== undefined &&\n        checksumAlgorithmFn !== undefined &&\n        checksumLocationName !== undefined &&\n        streamHasher !== undefined;\n    var digest = checksumRequired ? streamHasher(checksumAlgorithmFn, readableStream) : undefined;\n    var reader = readableStream.getReader();\n    return new ReadableStream({\n        pull: function (controller) {\n            return __awaiter(this, void 0, void 0, function () {\n                var _a, value, done, checksum, _b;\n                return __generator(this, function (_c) {\n                    switch (_c.label) {\n                        case 0: return [4, reader.read()];\n                        case 1:\n                            _a = _c.sent(), value = _a.value, done = _a.done;\n                            if (!done) return [3, 4];\n                            controller.enqueue(\"0\\r\\n\");\n                            if (!checksumRequired) return [3, 3];\n                            _b = base64Encoder;\n                            return [4, digest];\n                        case 2:\n                            checksum = _b.apply(void 0, [_c.sent()]);\n                            controller.enqueue(\"\".concat(checksumLocationName, \":\").concat(checksum, \"\\r\\n\"));\n                            controller.enqueue(\"\\r\\n\");\n                            _c.label = 3;\n                        case 3:\n                            controller.close();\n                            return [3, 5];\n                        case 4:\n                            controller.enqueue(\"\".concat((bodyLengthChecker(value) || 0).toString(16), \"\\r\\n\").concat(value, \"\\r\\n\"));\n                            _c.label = 5;\n                        case 5: return [2];\n                    }\n                });\n            });\n        },\n    });\n};\n"],"mappings":"AAAA,SAASA,SAAT,EAAoBC,WAApB,QAAuC,OAAvC;AACA,OAAO,IAAIC,2BAA2B,GAAG,UAAUC,cAAV,EAA0BC,OAA1B,EAAmC;EACxE,IAAIC,aAAa,GAAGD,OAAO,CAACC,aAA5B;EAAA,IAA2CC,iBAAiB,GAAGF,OAAO,CAACE,iBAAvE;EAAA,IAA0FC,mBAAmB,GAAGH,OAAO,CAACG,mBAAxH;EAAA,IAA6IC,oBAAoB,GAAGJ,OAAO,CAACI,oBAA5K;EAAA,IAAkMC,YAAY,GAAGL,OAAO,CAACK,YAAzN;EACA,IAAIC,gBAAgB,GAAGL,aAAa,KAAKM,SAAlB,IACnBL,iBAAiB,KAAKK,SADH,IAEnBJ,mBAAmB,KAAKI,SAFL,IAGnBH,oBAAoB,KAAKG,SAHN,IAInBF,YAAY,KAAKE,SAJrB;EAKA,IAAIC,MAAM,GAAGF,gBAAgB,GAAGD,YAAY,CAACF,mBAAD,EAAsBJ,cAAtB,CAAf,GAAuDQ,SAApF;EACA,IAAIE,MAAM,GAAGV,cAAc,CAACW,SAAf,EAAb;EACA,OAAO,IAAIC,cAAJ,CAAmB;IACtBC,IAAI,EAAE,UAAUC,UAAV,EAAsB;MACxB,OAAOjB,SAAS,CAAC,IAAD,EAAO,KAAK,CAAZ,EAAe,KAAK,CAApB,EAAuB,YAAY;QAC/C,IAAIkB,EAAJ,EAAQC,KAAR,EAAeC,IAAf,EAAqBC,QAArB,EAA+BC,EAA/B;;QACA,OAAOrB,WAAW,CAAC,IAAD,EAAO,UAAUsB,EAAV,EAAc;UACnC,QAAQA,EAAE,CAACC,KAAX;YACI,KAAK,CAAL;cAAQ,OAAO,CAAC,CAAD,EAAIX,MAAM,CAACY,IAAP,EAAJ,CAAP;;YACR,KAAK,CAAL;cACIP,EAAE,GAAGK,EAAE,CAACG,IAAH,EAAL,EAAgBP,KAAK,GAAGD,EAAE,CAACC,KAA3B,EAAkCC,IAAI,GAAGF,EAAE,CAACE,IAA5C;cACA,IAAI,CAACA,IAAL,EAAW,OAAO,CAAC,CAAD,EAAI,CAAJ,CAAP;cACXH,UAAU,CAACU,OAAX,CAAmB,OAAnB;cACA,IAAI,CAACjB,gBAAL,EAAuB,OAAO,CAAC,CAAD,EAAI,CAAJ,CAAP;cACvBY,EAAE,GAAGjB,aAAL;cACA,OAAO,CAAC,CAAD,EAAIO,MAAJ,CAAP;;YACJ,KAAK,CAAL;cACIS,QAAQ,GAAGC,EAAE,CAACM,KAAH,CAAS,KAAK,CAAd,EAAiB,CAACL,EAAE,CAACG,IAAH,EAAD,CAAjB,CAAX;cACAT,UAAU,CAACU,OAAX,CAAmB,GAAGE,MAAH,CAAUrB,oBAAV,EAAgC,GAAhC,EAAqCqB,MAArC,CAA4CR,QAA5C,EAAsD,MAAtD,CAAnB;cACAJ,UAAU,CAACU,OAAX,CAAmB,MAAnB;cACAJ,EAAE,CAACC,KAAH,GAAW,CAAX;;YACJ,KAAK,CAAL;cACIP,UAAU,CAACa,KAAX;cACA,OAAO,CAAC,CAAD,EAAI,CAAJ,CAAP;;YACJ,KAAK,CAAL;cACIb,UAAU,CAACU,OAAX,CAAmB,GAAGE,MAAH,CAAU,CAACvB,iBAAiB,CAACa,KAAD,CAAjB,IAA4B,CAA7B,EAAgCY,QAAhC,CAAyC,EAAzC,CAAV,EAAwD,MAAxD,EAAgEF,MAAhE,CAAuEV,KAAvE,EAA8E,MAA9E,CAAnB;cACAI,EAAE,CAACC,KAAH,GAAW,CAAX;;YACJ,KAAK,CAAL;cAAQ,OAAO,CAAC,CAAD,CAAP;UApBZ;QAsBH,CAvBiB,CAAlB;MAwBH,CA1Be,CAAhB;IA2BH;EA7BqB,CAAnB,CAAP;AA+BH,CAxCM"},"metadata":{},"sourceType":"module"}