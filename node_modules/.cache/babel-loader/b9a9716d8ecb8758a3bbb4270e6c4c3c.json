{"ast":null,"code":"import { __assign, __awaiter, __generator, __read } from \"tslib\";\nimport { getSuffixForArnEndpoint } from \"@aws-sdk/middleware-bucket-endpoint\";\nimport { HttpRequest } from \"@aws-sdk/protocol-http\";\nexport var writeGetObjectResponseEndpointMiddleware = function (config) {\n  return function (next, context) {\n    return function (args) {\n      return __awaiter(void 0, void 0, void 0, function () {\n        var regionProvider, isCustomEndpoint, disableHostPrefix, region, request, input, hostname, _a, suffix;\n\n        return __generator(this, function (_b) {\n          switch (_b.label) {\n            case 0:\n              regionProvider = config.region, isCustomEndpoint = config.isCustomEndpoint, disableHostPrefix = config.disableHostPrefix;\n              return [4, regionProvider()];\n\n            case 1:\n              region = _b.sent();\n              request = args.request, input = args.input;\n              if (!HttpRequest.isInstance(request)) return [2, next(__assign({}, args))];\n              hostname = request.hostname;\n\n              if (hostname.endsWith(\"s3.amazonaws.com\") || hostname.endsWith(\"s3-external-1.amazonaws.com\")) {\n                return [2, next(__assign({}, args))];\n              }\n\n              if (!isCustomEndpoint) {\n                _a = __read(getSuffixForArnEndpoint(request.hostname), 2), suffix = _a[1];\n                hostname = \"s3-object-lambda.\".concat(region, \".\").concat(suffix);\n              }\n\n              if (!disableHostPrefix && input.RequestRoute) {\n                hostname = \"\".concat(input.RequestRoute, \".\").concat(hostname);\n              }\n\n              request.hostname = hostname;\n              context[\"signing_service\"] = \"s3-object-lambda\";\n\n              if (config.runtime === \"node\" && !request.headers[\"content-length\"]) {\n                request.headers[\"transfer-encoding\"] = \"chunked\";\n              }\n\n              return [2, next(__assign({}, args))];\n          }\n        });\n      });\n    };\n  };\n};\nexport var writeGetObjectResponseEndpointMiddlewareOptions = {\n  relation: \"after\",\n  toMiddleware: \"contentLengthMiddleware\",\n  tags: [\"WRITE_GET_OBJECT_RESPONSE\", \"S3\", \"ENDPOINT\"],\n  name: \"writeGetObjectResponseEndpointMiddleware\",\n  override: true\n};\nexport var getWriteGetObjectResponseEndpointPlugin = function (config) {\n  return {\n    applyToStack: function (clientStack) {\n      clientStack.addRelativeTo(writeGetObjectResponseEndpointMiddleware(config), writeGetObjectResponseEndpointMiddlewareOptions);\n    }\n  };\n};","map":{"version":3,"names":["__assign","__awaiter","__generator","__read","getSuffixForArnEndpoint","HttpRequest","writeGetObjectResponseEndpointMiddleware","config","next","context","args","regionProvider","isCustomEndpoint","disableHostPrefix","region","request","input","hostname","_a","suffix","_b","label","sent","isInstance","endsWith","concat","RequestRoute","runtime","headers","writeGetObjectResponseEndpointMiddlewareOptions","relation","toMiddleware","tags","name","override","getWriteGetObjectResponseEndpointPlugin","applyToStack","clientStack","addRelativeTo"],"sources":["C:/Users/icean/aws-doc-sdk-examples/javascriptv3/example_code/cross-services/textract-react/node_modules/@aws-sdk/middleware-sdk-s3/dist-es/write-get-object-response-endpoint.js"],"sourcesContent":["import { __assign, __awaiter, __generator, __read } from \"tslib\";\nimport { getSuffixForArnEndpoint } from \"@aws-sdk/middleware-bucket-endpoint\";\nimport { HttpRequest } from \"@aws-sdk/protocol-http\";\nexport var writeGetObjectResponseEndpointMiddleware = function (config) {\n    return function (next, context) {\n        return function (args) { return __awaiter(void 0, void 0, void 0, function () {\n            var regionProvider, isCustomEndpoint, disableHostPrefix, region, request, input, hostname, _a, suffix;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        regionProvider = config.region, isCustomEndpoint = config.isCustomEndpoint, disableHostPrefix = config.disableHostPrefix;\n                        return [4, regionProvider()];\n                    case 1:\n                        region = _b.sent();\n                        request = args.request, input = args.input;\n                        if (!HttpRequest.isInstance(request))\n                            return [2, next(__assign({}, args))];\n                        hostname = request.hostname;\n                        if (hostname.endsWith(\"s3.amazonaws.com\") || hostname.endsWith(\"s3-external-1.amazonaws.com\")) {\n                            return [2, next(__assign({}, args))];\n                        }\n                        if (!isCustomEndpoint) {\n                            _a = __read(getSuffixForArnEndpoint(request.hostname), 2), suffix = _a[1];\n                            hostname = \"s3-object-lambda.\".concat(region, \".\").concat(suffix);\n                        }\n                        if (!disableHostPrefix && input.RequestRoute) {\n                            hostname = \"\".concat(input.RequestRoute, \".\").concat(hostname);\n                        }\n                        request.hostname = hostname;\n                        context[\"signing_service\"] = \"s3-object-lambda\";\n                        if (config.runtime === \"node\" && !request.headers[\"content-length\"]) {\n                            request.headers[\"transfer-encoding\"] = \"chunked\";\n                        }\n                        return [2, next(__assign({}, args))];\n                }\n            });\n        }); };\n    };\n};\nexport var writeGetObjectResponseEndpointMiddlewareOptions = {\n    relation: \"after\",\n    toMiddleware: \"contentLengthMiddleware\",\n    tags: [\"WRITE_GET_OBJECT_RESPONSE\", \"S3\", \"ENDPOINT\"],\n    name: \"writeGetObjectResponseEndpointMiddleware\",\n    override: true,\n};\nexport var getWriteGetObjectResponseEndpointPlugin = function (config) { return ({\n    applyToStack: function (clientStack) {\n        clientStack.addRelativeTo(writeGetObjectResponseEndpointMiddleware(config), writeGetObjectResponseEndpointMiddlewareOptions);\n    },\n}); };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}