{"ast":null,"code":"var STORE_NAME = \"IdentityIds\";\n\nvar IndexedDbStorage = function () {\n  function IndexedDbStorage(dbName) {\n    if (dbName === void 0) {\n      dbName = \"aws:cognito-identity-ids\";\n    }\n\n    this.dbName = dbName;\n  }\n\n  IndexedDbStorage.prototype.getItem = function (key) {\n    return this.withObjectStore(\"readonly\", function (store) {\n      var req = store.get(key);\n      return new Promise(function (resolve) {\n        req.onerror = function () {\n          return resolve(null);\n        };\n\n        req.onsuccess = function () {\n          return resolve(req.result ? req.result.value : null);\n        };\n      });\n    }).catch(function () {\n      return null;\n    });\n  };\n\n  IndexedDbStorage.prototype.removeItem = function (key) {\n    return this.withObjectStore(\"readwrite\", function (store) {\n      var req = store.delete(key);\n      return new Promise(function (resolve, reject) {\n        req.onerror = function () {\n          return reject(req.error);\n        };\n\n        req.onsuccess = function () {\n          return resolve();\n        };\n      });\n    });\n  };\n\n  IndexedDbStorage.prototype.setItem = function (id, value) {\n    return this.withObjectStore(\"readwrite\", function (store) {\n      var req = store.put({\n        id: id,\n        value: value\n      });\n      return new Promise(function (resolve, reject) {\n        req.onerror = function () {\n          return reject(req.error);\n        };\n\n        req.onsuccess = function () {\n          return resolve();\n        };\n      });\n    });\n  };\n\n  IndexedDbStorage.prototype.getDb = function () {\n    var openDbRequest = self.indexedDB.open(this.dbName, 1);\n    return new Promise(function (resolve, reject) {\n      openDbRequest.onsuccess = function () {\n        resolve(openDbRequest.result);\n      };\n\n      openDbRequest.onerror = function () {\n        reject(openDbRequest.error);\n      };\n\n      openDbRequest.onblocked = function () {\n        reject(new Error(\"Unable to access DB\"));\n      };\n\n      openDbRequest.onupgradeneeded = function () {\n        var db = openDbRequest.result;\n\n        db.onerror = function () {\n          reject(new Error(\"Failed to create object store\"));\n        };\n\n        db.createObjectStore(STORE_NAME, {\n          keyPath: \"id\"\n        });\n      };\n    });\n  };\n\n  IndexedDbStorage.prototype.withObjectStore = function (mode, action) {\n    return this.getDb().then(function (db) {\n      var tx = db.transaction(STORE_NAME, mode);\n\n      tx.oncomplete = function () {\n        return db.close();\n      };\n\n      return new Promise(function (resolve, reject) {\n        tx.onerror = function () {\n          return reject(tx.error);\n        };\n\n        resolve(action(tx.objectStore(STORE_NAME)));\n      }).catch(function (err) {\n        db.close();\n        throw err;\n      });\n    });\n  };\n\n  return IndexedDbStorage;\n}();\n\nexport { IndexedDbStorage };","map":{"version":3,"names":["STORE_NAME","IndexedDbStorage","dbName","prototype","getItem","key","withObjectStore","store","req","get","Promise","resolve","onerror","onsuccess","result","value","catch","removeItem","delete","reject","error","setItem","id","put","getDb","openDbRequest","self","indexedDB","open","onblocked","Error","onupgradeneeded","db","createObjectStore","keyPath","mode","action","then","tx","transaction","oncomplete","close","objectStore","err"],"sources":["C:/Users/icean/aws-doc-sdk-examples/javascriptv3/example_code/cross-services/textract-react/node_modules/@aws-sdk/credential-provider-cognito-identity/dist-es/IndexedDbStorage.js"],"sourcesContent":["var STORE_NAME = \"IdentityIds\";\nvar IndexedDbStorage = (function () {\n    function IndexedDbStorage(dbName) {\n        if (dbName === void 0) { dbName = \"aws:cognito-identity-ids\"; }\n        this.dbName = dbName;\n    }\n    IndexedDbStorage.prototype.getItem = function (key) {\n        return this.withObjectStore(\"readonly\", function (store) {\n            var req = store.get(key);\n            return new Promise(function (resolve) {\n                req.onerror = function () { return resolve(null); };\n                req.onsuccess = function () { return resolve(req.result ? req.result.value : null); };\n            });\n        }).catch(function () { return null; });\n    };\n    IndexedDbStorage.prototype.removeItem = function (key) {\n        return this.withObjectStore(\"readwrite\", function (store) {\n            var req = store.delete(key);\n            return new Promise(function (resolve, reject) {\n                req.onerror = function () { return reject(req.error); };\n                req.onsuccess = function () { return resolve(); };\n            });\n        });\n    };\n    IndexedDbStorage.prototype.setItem = function (id, value) {\n        return this.withObjectStore(\"readwrite\", function (store) {\n            var req = store.put({ id: id, value: value });\n            return new Promise(function (resolve, reject) {\n                req.onerror = function () { return reject(req.error); };\n                req.onsuccess = function () { return resolve(); };\n            });\n        });\n    };\n    IndexedDbStorage.prototype.getDb = function () {\n        var openDbRequest = self.indexedDB.open(this.dbName, 1);\n        return new Promise(function (resolve, reject) {\n            openDbRequest.onsuccess = function () {\n                resolve(openDbRequest.result);\n            };\n            openDbRequest.onerror = function () {\n                reject(openDbRequest.error);\n            };\n            openDbRequest.onblocked = function () {\n                reject(new Error(\"Unable to access DB\"));\n            };\n            openDbRequest.onupgradeneeded = function () {\n                var db = openDbRequest.result;\n                db.onerror = function () {\n                    reject(new Error(\"Failed to create object store\"));\n                };\n                db.createObjectStore(STORE_NAME, { keyPath: \"id\" });\n            };\n        });\n    };\n    IndexedDbStorage.prototype.withObjectStore = function (mode, action) {\n        return this.getDb().then(function (db) {\n            var tx = db.transaction(STORE_NAME, mode);\n            tx.oncomplete = function () { return db.close(); };\n            return new Promise(function (resolve, reject) {\n                tx.onerror = function () { return reject(tx.error); };\n                resolve(action(tx.objectStore(STORE_NAME)));\n            }).catch(function (err) {\n                db.close();\n                throw err;\n            });\n        });\n    };\n    return IndexedDbStorage;\n}());\nexport { IndexedDbStorage };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}