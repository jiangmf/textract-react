{"ast":null,"code":"import { __awaiter, __generator } from \"tslib\";\nimport { GetIdCommand } from \"@aws-sdk/client-cognito-identity\";\nimport { CredentialsProviderError } from \"@aws-sdk/property-provider\";\nimport { fromCognitoIdentity } from \"./fromCognitoIdentity\";\nimport { localStorage } from \"./localStorage\";\nimport { resolveLogins } from \"./resolveLogins\";\nexport function fromCognitoIdentityPool(_a) {\n  var _this = this;\n\n  var accountId = _a.accountId,\n      _b = _a.cache,\n      cache = _b === void 0 ? localStorage() : _b,\n      client = _a.client,\n      customRoleArn = _a.customRoleArn,\n      identityPoolId = _a.identityPoolId,\n      logins = _a.logins,\n      _c = _a.userIdentifier,\n      userIdentifier = _c === void 0 ? !logins || Object.keys(logins).length === 0 ? \"ANONYMOUS\" : undefined : _c;\n  var cacheKey = userIdentifier ? \"aws:cognito-identity-credentials:\".concat(identityPoolId, \":\").concat(userIdentifier) : undefined;\n\n  var provider = function () {\n    return __awaiter(_this, void 0, void 0, function () {\n      var identityId, _a, _b, IdentityId, _c, _d, _e, _f;\n\n      var _g;\n\n      return __generator(this, function (_h) {\n        switch (_h.label) {\n          case 0:\n            _a = cacheKey;\n            if (!_a) return [3, 2];\n            return [4, cache.getItem(cacheKey)];\n\n          case 1:\n            _a = _h.sent();\n            _h.label = 2;\n\n          case 2:\n            identityId = _a;\n            if (!!identityId) return [3, 7];\n            _d = (_c = client).send;\n            _e = GetIdCommand.bind;\n            _g = {\n              AccountId: accountId,\n              IdentityPoolId: identityPoolId\n            };\n            if (!logins) return [3, 4];\n            return [4, resolveLogins(logins)];\n\n          case 3:\n            _f = _h.sent();\n            return [3, 5];\n\n          case 4:\n            _f = undefined;\n            _h.label = 5;\n\n          case 5:\n            return [4, _d.apply(_c, [new (_e.apply(GetIdCommand, [void 0, (_g.Logins = _f, _g)]))()])];\n\n          case 6:\n            _b = _h.sent().IdentityId, IdentityId = _b === void 0 ? throwOnMissingId() : _b;\n            identityId = IdentityId;\n\n            if (cacheKey) {\n              Promise.resolve(cache.setItem(cacheKey, identityId)).catch(function () {});\n            }\n\n            _h.label = 7;\n\n          case 7:\n            provider = fromCognitoIdentity({\n              client: client,\n              customRoleArn: customRoleArn,\n              logins: logins,\n              identityId: identityId\n            });\n            return [2, provider()];\n        }\n      });\n    });\n  };\n\n  return function () {\n    return provider().catch(function (err) {\n      return __awaiter(_this, void 0, void 0, function () {\n        return __generator(this, function (_a) {\n          if (cacheKey) {\n            Promise.resolve(cache.removeItem(cacheKey)).catch(function () {});\n          }\n\n          throw err;\n        });\n      });\n    });\n  };\n}\n\nfunction throwOnMissingId() {\n  throw new CredentialsProviderError(\"Response from Amazon Cognito contained no identity ID\");\n}","map":{"version":3,"names":["__awaiter","__generator","GetIdCommand","CredentialsProviderError","fromCognitoIdentity","localStorage","resolveLogins","fromCognitoIdentityPool","_a","_this","accountId","_b","cache","client","customRoleArn","identityPoolId","logins","_c","userIdentifier","Object","keys","length","undefined","cacheKey","concat","provider","identityId","IdentityId","_d","_e","_f","_g","_h","label","getItem","sent","send","bind","AccountId","IdentityPoolId","apply","Logins","throwOnMissingId","Promise","resolve","setItem","catch","err","removeItem"],"sources":["C:/Users/icean/aws-doc-sdk-examples/javascriptv3/example_code/cross-services/textract-react/node_modules/@aws-sdk/credential-provider-cognito-identity/dist-es/fromCognitoIdentityPool.js"],"sourcesContent":["import { __awaiter, __generator } from \"tslib\";\nimport { GetIdCommand } from \"@aws-sdk/client-cognito-identity\";\nimport { CredentialsProviderError } from \"@aws-sdk/property-provider\";\nimport { fromCognitoIdentity } from \"./fromCognitoIdentity\";\nimport { localStorage } from \"./localStorage\";\nimport { resolveLogins } from \"./resolveLogins\";\nexport function fromCognitoIdentityPool(_a) {\n    var _this = this;\n    var accountId = _a.accountId, _b = _a.cache, cache = _b === void 0 ? localStorage() : _b, client = _a.client, customRoleArn = _a.customRoleArn, identityPoolId = _a.identityPoolId, logins = _a.logins, _c = _a.userIdentifier, userIdentifier = _c === void 0 ? !logins || Object.keys(logins).length === 0 ? \"ANONYMOUS\" : undefined : _c;\n    var cacheKey = userIdentifier ? \"aws:cognito-identity-credentials:\".concat(identityPoolId, \":\").concat(userIdentifier) : undefined;\n    var provider = function () { return __awaiter(_this, void 0, void 0, function () {\n        var identityId, _a, _b, IdentityId, _c, _d, _e, _f;\n        var _g;\n        return __generator(this, function (_h) {\n            switch (_h.label) {\n                case 0:\n                    _a = cacheKey;\n                    if (!_a) return [3, 2];\n                    return [4, cache.getItem(cacheKey)];\n                case 1:\n                    _a = (_h.sent());\n                    _h.label = 2;\n                case 2:\n                    identityId = _a;\n                    if (!!identityId) return [3, 7];\n                    _d = (_c = client).send;\n                    _e = GetIdCommand.bind;\n                    _g = {\n                        AccountId: accountId,\n                        IdentityPoolId: identityPoolId\n                    };\n                    if (!logins) return [3, 4];\n                    return [4, resolveLogins(logins)];\n                case 3:\n                    _f = _h.sent();\n                    return [3, 5];\n                case 4:\n                    _f = undefined;\n                    _h.label = 5;\n                case 5: return [4, _d.apply(_c, [new (_e.apply(GetIdCommand, [void 0, (_g.Logins = _f,\n                                _g)]))()])];\n                case 6:\n                    _b = (_h.sent()).IdentityId, IdentityId = _b === void 0 ? throwOnMissingId() : _b;\n                    identityId = IdentityId;\n                    if (cacheKey) {\n                        Promise.resolve(cache.setItem(cacheKey, identityId)).catch(function () { });\n                    }\n                    _h.label = 7;\n                case 7:\n                    provider = fromCognitoIdentity({\n                        client: client,\n                        customRoleArn: customRoleArn,\n                        logins: logins,\n                        identityId: identityId,\n                    });\n                    return [2, provider()];\n            }\n        });\n    }); };\n    return function () {\n        return provider().catch(function (err) { return __awaiter(_this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                if (cacheKey) {\n                    Promise.resolve(cache.removeItem(cacheKey)).catch(function () { });\n                }\n                throw err;\n            });\n        }); });\n    };\n}\nfunction throwOnMissingId() {\n    throw new CredentialsProviderError(\"Response from Amazon Cognito contained no identity ID\");\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}